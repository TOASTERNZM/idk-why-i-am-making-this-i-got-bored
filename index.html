<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rainbow Music Header</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg-gif: url("download2.png?v=2");
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body {
  width: 100%;
  height: 100%;
}

body {
  background: var(--bg-gif) no-repeat center center;
  background-size: cover;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
  font-family: 'Arial', sans-serif;
}

/* Scrolling rainbow header container */
#headerWrapper {
  position: absolute;
  top: 20px;
  width: 100%;
  overflow: hidden; /* hides text outside the screen */
}

/* Rainbow scrolling header */
#fancyHeader {
  display: inline-block;
  white-space: nowrap; /* ensures it doesnâ€™t wrap */
  font-size: 3rem;
  font-weight: bold;
  text-transform: uppercase;
  user-select: none;
  pointer-events: none;
  animation: scrollLeft 15s linear infinite, rainbow 3s infinite linear;
}

/* Horizontal scroll animation */
@keyframes scrollLeft {
  0% { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}

/* Rainbow color animation */
@keyframes rainbow {
  0% { color: red; text-shadow: 0 0 10px red, 0 0 20px red, 0 0 30px red; }
  16% { color: orange; text-shadow: 0 0 10px orange, 0 0 20px orange, 0 0 30px orange; }
  33% { color: yellow; text-shadow: 0 0 10px yellow, 0 0 20px yellow, 0 0 30px yellow; }
  50% { color: green; text-shadow: 0 0 10px green, 0 0 20px green, 0 0 30px green; }
  66% { color: blue; text-shadow: 0 0 10px blue, 0 0 20px blue, 0 0 30px blue; }
  83% { color: violet; text-shadow: 0 0 10px violet, 0 0 20px violet, 0 0 30px violet; }
  100% { color: red; text-shadow: 0 0 10px red, 0 0 20px red, 0 0 30px red; }
}

#clickText {
  color: white;
  font-size: 2rem;
  text-shadow: 0 0 10px black;
  transition: opacity 1s ease;
  pointer-events: none;
  user-select: none;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  text-align: center;
}

#visualizer {
  position: absolute;
  bottom: 50px;
  width: 80%;
  height: 100px;
}
</style>
</head>

<body>

<audio id="bgm" loop>
  <source src="night.mp3" type="audio/mpeg">
</audio>

<!-- Header wrapper for scrolling -->
<div id="headerWrapper">
  <div id="fancyHeader">My Cool Header</div>
</div>

<div id="clickText">Click to play</div>
<canvas id="visualizer"></canvas>

<script>
const body = document.body;
const audio = document.getElementById("bgm");
const clickText = document.getElementById("clickText");
const canvas = document.getElementById("visualizer");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth * 0.8;
canvas.height = 100;

let audioCtx, analyser, source, dataArray;

body.addEventListener("click", () => {
  audio.play();
  clickText.style.opacity = 0;

  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  analyser = audioCtx.createAnalyser();
  source = audioCtx.createMediaElementSource(audio);
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  analyser.fftSize = 128;

  const bufferLength = analyser.frequencyBinCount;
  dataArray = new Uint8Array(bufferLength);

  requestAnimationFrame(drawVisualizer);
}, { once: true });

function drawVisualizer() {
  requestAnimationFrame(drawVisualizer);
  analyser.getByteFrequencyData(dataArray);

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const barWidth = (canvas.width / dataArray.length) * 2.5;
  let x = 0;

  for(let i = 0; i < dataArray.length; i++){
    const barHeight = dataArray[i] / 2;
    ctx.fillStyle = `hsl(${i * 10}, 100%, 50%)`; 
    ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
    x += barWidth + 1;
  }
}

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth * 0.8;
  canvas.height = 100;
});
</script>

</body>
</html>
